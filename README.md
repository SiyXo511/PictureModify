# 图片修改工具 - 项目生成指南

## 项目说明

这是一个图片编辑工具的项目需求文档和生成Prompt。本项目旨在开发一个桌面应用程序，用于图片编辑，主要功能包括：

1. **垂直删除拼接**：删除垂直选中的区域，并将剩余部分拼接
2. **智能背景填充**：删除选中区域，并使用智能算法填充背景
3. **文字识别、删除与替换**：使用OCR识别图片中的文字，删除原文字并用相同字体替换为新文字

## 文件说明

### 1. PROJECT_REQUIREMENTS.md
详细的项目需求文档，包含：
- 功能需求详细说明
- 技术栈建议
- 项目结构设计
- 用户界面设计
- 技术实现细节

### 2. PROJECT_GENERATION_PROMPT.md
完整的项目生成Prompt，可以直接用于：
- 向AI助手（如ChatGPT、Claude等）提问
- 作为开发文档参考
- 指导项目开发

## 如何使用

### 方法一：使用AI生成项目
1. 打开 `PROJECT_GENERATION_PROMPT.md`
2. 复制其中的内容
3. 粘贴到AI助手（如ChatGPT、Claude、Cursor等）
4. AI将根据Prompt生成完整的项目代码

### 方法二：手动开发
1. 参考 `PROJECT_REQUIREMENTS.md` 中的需求
2. 按照技术栈和项目结构进行开发
3. 实现所有核心功能

## 技术栈

- **Python 3.8+**
- **PyQt5** - GUI框架
- **Pillow** - 图像处理和文字渲染
- **OpenCV** - 高级图像处理
- **NumPy** - 数组操作
- **PaddleOCR** - 文字识别（OCR），支持中英文
- **PyInstaller** - 打包工具

## 核心功能

### 1. 垂直删除拼接
- 选择垂直区域
- 删除选中部分
- 自动拼接上下两部分

### 2. 智能背景填充
- 多种填充模式：
  - 智能填充（OpenCV inpaint）
  - 平均颜色填充
  - 纯色填充
  - 中位数填充

### 3. 文字识别、删除与替换
- **文字识别（OCR）**：
  - 使用PaddleOCR识别选中区域的文字
  - 支持中文、英文、中英文混合识别
  - 显示识别结果和置信度
  - 允许用户编辑识别结果
  
- **文字删除**：
  - 智能删除识别到的文字
  - 使用inpaint算法保持背景自然
  
- **文字替换**：
  - 自动提取原文字的字体特征（大小、颜色、样式等）
  - 智能匹配系统字体
  - 使用相同字体特征渲染新文字
  - 支持手动调整字体参数

### 4. 其他功能
- 撤销/重做（支持10+步）
- 图片缩放查看
- 保存/另存为
- 支持多种图片格式

## 开发步骤

1. **环境准备**
   ```bash
   pip install -r requirements.txt
   ```
   或手动安装：
   ```bash
   pip install PyQt5 Pillow opencv-python numpy paddlepaddle paddleocr PyInstaller
   ```
   
   **注意**：PaddleOCR首次使用时会自动下载模型文件（约100MB），需要网络连接。

2. **项目结构**
   ```
   PictureModify/
   ├── src/
   │   ├── main.py
   │   ├── gui/
   │   ├── core/
   │   └── utils/
   ├── requirements.txt
   └── README.md
   ```

3. **开发顺序**
   - 创建主窗口框架
   - 实现图片加载和显示
   - 实现选择工具
   - 实现核心功能（垂直删除、智能填充）
   - 实现OCR文字识别功能
   - 实现文字删除和替换功能
   - 实现撤销/重做
   - 完善UI和用户体验
   - 测试和优化
   - 打包成exe

4. **打包exe**
   ```bash
   pyinstaller --onefile --windowed --name PictureModify src/main.py
   ```

## 注意事项

1. **图片格式支持**：确保支持常见格式（JPG, PNG, BMP等）
2. **大图片处理**：考虑性能，可能需要进度提示
3. **内存管理**：历史记录可能占用较多内存，需要限制数量
4. **用户体验**：提供清晰的操作提示和错误信息
5. **中文支持**：确保界面和提示支持中文
6. **OCR模型下载**：PaddleOCR首次使用需要下载模型文件，需要网络连接和一定时间
7. **字体匹配**：字体自动匹配可能不完全准确，需要提供手动选择字体的选项
8. **文字识别准确度**：OCR识别准确度取决于图片质量，复杂背景可能影响识别效果

## 后续扩展

可以考虑添加的功能：
- 批量处理多张图片
- 更多选择工具（圆形、多边形）
- 图片滤镜效果
- 历史记录预览
- 导出处理步骤
- 文字样式高级调整（描边、阴影、渐变等）
- 支持多行文字的识别和替换
- 文字识别结果导出为文本文件

## 联系与支持

如有问题或建议，请参考项目需求文档或使用生成Prompt向AI助手寻求帮助。

